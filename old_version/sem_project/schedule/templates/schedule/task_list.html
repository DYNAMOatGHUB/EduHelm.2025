{% extends "users/base.html" %}

{% block title %}My Schedule | EduHelm{% endblock %}
{% block schedule_active %}active{% endblock schedule_active %}

{% block content %}
<div class="profile-container">
    <div class="settings-section">
        <div class="list-header">
            <h2 class="section-title"><i class="fas fa-calendar-alt"></i> My Schedule</h2>
            <a href="{% url 'schedule:task_create' %}" class="action-button add-task-btn">
                <i class="fas fa-plus"></i> Add New Task
            </a>
        </div>
        <p style="color: var(--subtle-text); margin-top: -10px; margin-bottom: 25px;">
            Here are all your scheduled tasks and reminders.
        </p>
        <div class="task-list-container">
            {% if object_list %}
                {% for task in object_list %}
                    {% if task.due_date and not task.is_completed and task.due_date < current_time %}
                        <div class="task-item-row overdue">
                    {% else %}
                        <div class="task-item-row">
                    {% endif %}
                        <div class="task-status">
                            <form action="{% url 'schedule:task_toggle' task.pk %}" method="POST" style="margin: 0;">
                                {% csrf_token %}
                                <button type="submit" class="toggle-complete-btn">
                                    {% if task.is_completed %}
                                        <i class="fas fa-check-circle completed"></i>
                                    {% else %}
                                        <i class="far fa-circle pending"></i>
                                    {% endif %}
                                </button>
                            </form>
                        </div>
                        <div class="task-info">
                            <a href="{% url 'schedule:task_detail' task.pk %}" class="task-title-link">
                                {{ task.title }}
                            </a>
                            <p class="task-due-date">
                                {% if task.due_date %}
                                    <i class="fas fa-clock"></i> Due: {{ task.due_date|date:"F d, Y P" }}
                                {% else %}
                                    <i class="fas fa-calendar-times"></i> No due date set
                                {% endif %}
                            </p>
                        </div>
                        <div class="task-actions">
                            <a href="{% url 'schedule:task_update' task.pk %}" class="action-button-sm"><i class="fas fa-edit"></i></a>
                            <a href="{% url 'schedule:task_delete' task.pk %}" class="action-button-sm delete"><i class="fas fa-trash"></i></a>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="no-tasks-message">
                    <i class="fas fa-folder-open"></i>
                    <h3>No tasks found.</h3>
                    <p>Get started by adding a new task to your schedule!</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}