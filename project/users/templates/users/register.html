{% extends "users/base.html" %}
{% load static %}

{% block content %}
<style>
:root{
    --neon-pink: #ff60c0;
    --aqua: #00eaff;
    --bg-purple: #4d1c9d;
    --bg-blue: #0084ff;
    --card-bg: rgba(255,255,255,0.12);
}

/* Page background */
body{
    margin:0;
    padding:0;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background: linear-gradient(135deg, #ff60c0, #ff9a76, #00eaff);
    font-family:'Poppins', sans-serif;
    color:#fff;
    overflow-y: hidden;
    overflow-x: hidden;
}

/* ========== ENTRANCE ANIMATIONS ========== */
@keyframes fadeInUp{
    from{ opacity: 0; transform: translateY(40px); }
    to{ opacity: 1; transform: translateY(0); }
}
@keyframes fadeInLeft{
    from{ opacity: 0; transform: translateX(-50px); }
    to{ opacity: 1; transform: translateX(0); }
}
@keyframes fadeInRight{
    from{ opacity: 0; transform: translateX(50px); }
    to{ opacity: 1; transform: translateX(0); }
}
@keyframes scaleIn{
    from{ opacity: 0; transform: scale(0.8); }
    to{ opacity: 1; transform: scale(1); }
}

/* Background soft orbs */
.bg-orb{
    position:absolute;
    border-radius:50%;
    filter: blur(12vw);
    opacity:0.28;
    z-index:1;
    animation: pulse 8s ease-in-out infinite;
}
.orb-left{
    width:45vw; height:45vw;
    left:-10vw; top:-8vh;
    background:#2a004a;
    animation: drift 24s infinite alternate, pulse 6s ease-in-out infinite;
}
.orb-right{
    width:42vw; height:42vw;
    right:-8vw; bottom:-10vh;
    background:var(--aqua);
    animation: drift 24s infinite alternate, pulse 8s ease-in-out infinite reverse;
}
@keyframes drift{ 
    from { transform: translateY(0) translateX(0);} 
    to { transform: translateY(-4vh) translateX(3vw);} 
}
@keyframes pulse{
    0%, 100%{ opacity: 0.28; filter: blur(12vw); }
    50%{ opacity: 0.4; filter: blur(15vw); }
}

/* Main card (responsive two-column layout) */
.register-wrapper{
    position:relative;
    z-index:50;
    width:min(85vw, 750px);
    max-width:850px;
    margin:2vh auto;
    display:flex;
    gap:1.5rem;
    align-items:stretch;
    transform: scale(0.9);
}

/* Left: branding panel */
.brand-panel{
    flex: 0 0 min(36%, 320px);
    min-width:220px;
    background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
    border-radius: 40px;
    padding: clamp(1.2rem, 2.5vh, 1.8rem);
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    box-shadow: 0 18px 40px rgba(0,0,0,0.35);
    border:1px solid rgba(255,255,255,0.06);
    backdrop-filter: blur(8px);
    animation: fadeInLeft 0.8s ease-out;
    transition: all 0.3s ease;
    text-align: center;
}
.brand-panel:hover{
    transform: translateY(-5px);
    box-shadow: 0 25px 50px rgba(0,0,0,0.5), 0 0 30px rgba(0, 234, 255, 0.3);
}

/* EduHelm emblem */
.brand-badge{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:0.5rem;
    margin-bottom:0.6rem;
    user-select:none;
    width: 100%;
}

/* logo image */
.brand-icon{
    width: 130px !important;
    height: 130px !important;
    border-radius: 0 !important;
    background: none !important;
    box-shadow: none !important;
    object-fit: contain;
    transition: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    filter: drop-shadow(0 0 25px rgba(0, 234, 255, 0.6));
    margin-bottom: 0;
}
.brand-icon:hover{
    transform: rotate(360deg) scale(1.15) !important;
    filter: drop-shadow(0 0 35px rgba(255, 96, 192, 0.9));
}

/* big stylized text */
.brand-title{
    font-weight:900;
    font-size: clamp(1.8rem, 4.2vw, 2.8rem);
    line-height:1.1;
    color: white;
    letter-spacing: 0.02em;
    text-shadow: 0 0 20px rgba(0, 234, 255, 0.6), 0 0 40px rgba(255, 96, 192, 0.4);
    margin:0;
    background: linear-gradient(135deg, #ffffff, #00eaff, #ff60c0);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: textShine 3s ease-in-out infinite;
}

@keyframes textShine {
    0%, 100% { filter: brightness(1) drop-shadow(0 0 15px rgba(0, 234, 255, 0.5)); }
    50% { filter: brightness(1.3) drop-shadow(0 0 25px rgba(255, 96, 192, 0.7)); }
}

/* tagline */
.brand-tag{
    margin-top:0.3rem;
    color: rgba(255,255,255,0.95);
    font-weight:600;
    font-size: clamp(0.85rem, 1.5vw, 1rem);
    opacity:0.95;
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    letter-spacing: 0.5px;
}

/* Right: form panel */
.form-panel{
    flex:1 1 420px;
    background: var(--card-bg);
    border-radius: 40px;
    padding: clamp(1.2rem, 2.8vh, 2.2rem);
    box-shadow: 0 18px 40px rgba(0,0,0,0.45);
    border: 1px solid rgba(255,255,255,0.06);
    backdrop-filter: blur(8px);
    display:flex;
    flex-direction:column;
    justify-content:space-between;
    animation: fadeInRight 0.8s ease-out;
    transition: all 0.3s ease;
}
.form-panel:hover{
    transform: translateY(-5px);
    box-shadow: 0 25px 50px rgba(0,0,0,0.6), 0 0 30px rgba(255, 96, 192, 0.3);
}

/* Form top heading inside form panel */
.form-panel .heading{
    text-align:center;
    margin-bottom:1.5rem;
}
.form-panel h2{
    font-size: clamp(1.4rem, 2.6vw, 1.9rem);
    margin:0 0 0.6rem 0;
    color:#fff;
    font-weight:800;
    text-shadow: 0 2px 15px rgba(0, 234, 255, 0.4);
    letter-spacing: 0.5px;
}

/* form body */
.form-body{
    width:100%;
}

/* single field */
.form-group{
    margin-bottom:1rem;
    width:100%;
    animation: fadeInUp 0.6s ease-out backwards;
}
.form-group:nth-child(1){ animation-delay: 0.2s; }
.form-group:nth-child(2){ animation-delay: 0.3s; }
.form-group:nth-child(3){ animation-delay: 0.4s; }
.form-group:nth-child(4){ animation-delay: 0.5s; }

.form-field{
    width:100%;
    padding: clamp(0.75rem,1.6vh,1.05rem) clamp(0.9rem,1.8vw,1.2rem);
    border-radius:50px;
    border:1px solid rgba(255,255,255,0.12);
    background: rgba(255,255,255,0.06);
    color:#fff;
    font-size: clamp(0.95rem, 1.8vw, 1.12rem);
    outline:none;
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    box-sizing:border-box;
    position: relative;
}
.form-field::placeholder{ 
    color: rgba(255,255,255,0.95); 
    transition: all 0.3s ease;
}
.form-field:focus{ 
    border-color: var(--aqua); 
    transform: translateY(-3px) scale(1.02); 
    box-shadow: 0 10px 25px rgba(0, 234, 255, 0.3), 0 0 20px rgba(0, 234, 255, 0.2);
    background: rgba(255,255,255,0.1);
}
.form-field:focus::placeholder{
    transform: translateX(10px);
    opacity: 0.7;
}

/* submit button */
.form-actions{
    margin-top:1rem;
    animation: scaleIn 0.6s ease-out 0.6s backwards;
}
.btn-submit{
    display:block;
    width:100%;
    padding: clamp(0.8rem,1.8vh,1.05rem);
    border-radius:100px;
    border:none;
    font-weight:800;
    font-size: clamp(1rem,2.2vw,1.18rem);
    cursor:pointer;
    background: linear-gradient(90deg, var(--neon-pink), var(--aqua));
    color:#fff;
    box-shadow: 0 10px 30px rgba(0,0,0,0.35);
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    position: relative;
    overflow: hidden;
}
.btn-submit::before{
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255,255,255,0.3);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
}
.btn-submit:hover::before{
    width: 300px;
    height: 300px;
}
.btn-submit:hover{ 
    transform: translateY(-5px) scale(1.05); 
    box-shadow: 0 20px 45px rgba(0,0,0,0.5), 0 0 40px rgba(255, 96, 192, 0.6);
    background: linear-gradient(90deg, var(--aqua), var(--neon-pink));
}
.btn-submit:active{
    transform: translateY(-2px) scale(1.02);
}

/* small login link under the button */
.form-footer{
    margin-top:1rem;
    text-align:center;
    font-size:0.95rem;
    color: rgba(255,255,255,0.85);
}
.form-footer a{ color: var(--aqua); font-weight:700; text-decoration:none; }
.form-footer a:hover{ color: var(--neon-pink); }

/* error list */
.error-list{ list-style:none; padding:0; margin:0.35rem 0 0 0; color:#ffc93c; font-size:0.95rem; }

/* Responsive adjustments */
@media (max-width: 900px){
    .register-wrapper{ flex-direction:column-reverse; width:92vw; gap:1.2rem; }
    .brand-panel{ width:100%; min-width:unset; align-items:center; text-align:center; padding:1.2rem 1rem; }
    .brand-badge{ justify-content:center; }
    .brand-title{ font-size:clamp(1.6rem,5.6vw,2.6rem); }
    .form-panel{ width:100%; padding:1.2rem; }
}
@media (max-width:480px){
    .brand-icon{ transform: none; width:64px; height:64px; }
    .brand-title{ font-size:1.45rem; }
    .form-field{ font-size:0.95rem; padding:0.7rem 0.9rem; }
    .btn-submit{ font-size:1rem; padding:0.8rem; }
}
</style>

<div class="bg-orb orb-left"></div>
<div class="bg-orb orb-right"></div>

<div class="register-wrapper">

    <aside class="brand-panel" aria-hidden="false">
        <div class="brand-badge">
            <img src="{% static 'users/logo.svg' %}" alt="EduHelm Logo" class="brand-icon">
            <div style="width: 100%;">
                <h1 class="brand-title">EduHelm</h1>
                <div class="brand-tag">Navigate learning. Master skills.</div>
            </div>
        </div>
        <p style="margin-top:0; color:rgba(255,255,255,0.9); font-weight:500; font-size:0.9rem; line-height:1.4; text-align:center; padding:0;">
            Join EduHelm to access curated courses, practice problems, and community feedback.
        </p>
    </aside>

    <section class="form-panel" role="region" aria-label="Create your account">
        <div class="heading">
            <h2>Create Your Account</h2>
            <div style="font-size:0.95rem; color:rgba(255,255,255,0.8);">Start your learning journey today</div>
        </div>

        <form method="POST" class="form-body" novalidate>
            {% csrf_token %}

            {% if form.non_field_errors %}
                <div class="non-field-errors">
                    {% for error in form.non_field_errors %}
                        <ul class="error-list"><li>{{ error }}</li></ul>
                    {% endfor %}
                </div>
            {% endif %}

            {% for field in form %}
                <div class="form-group">
                    <input
                        type="{{ field.field.widget.input_type }}"
                        name="{{ field.name }}"
                        id="{{ field.id_for_label }}"
                        {% if field.name == 'username' %}
                            placeholder="Username"
                        {% elif field.name == 'email' %}
                            placeholder="Email Address"
                        {% elif field.name == 'password1' %}
                            placeholder="Password"
                        {% elif field.name == 'password2' %}
                            placeholder="Confirm Password"
                        {% else %}
                            placeholder="{{ field.label }}"
                        {% endif %}
                        class="form-field"
                        {% if field.value and field.name != 'password' and field.name != 'password1' and field.name != 'password2' %}
                            value="{{ field.value }}"
                        {% endif %}
                        {% if field.field.required %} required {% endif %}
                    >
                    {% if field.errors %}
                        <ul class="error-list">
                            {% for error in field.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>
            {% endfor %}

            <div class="form-actions">
                <button type="submit" class="btn-submit">Sign Up</button>
            </div>

            <div class="form-footer">
                Already have an account? <a href="{% url 'login' %}">Login</a>
            </div>
        </form>
    </section>
</div>

<script>
let particles = [];
const particleCount = 20;

class Particle {
    constructor(x, y) {
        this.x = x;
        this.y = y;
        this.size = Math.random() * 5 + 2;
        this.speedX = Math.random() * 3 - 1.5;
        this.speedY = Math.random() * 3 - 1.5;
        this.opacity = 1;
        this.color = Math.random() > 0.5 ? '#ff60c0' : '#00eaff';
        
        this.element = document.createElement('div');
        this.element.style.position = 'fixed';
        this.element.style.width = this.size + 'px';
        this.element.style.height = this.size + 'px';
        this.element.style.borderRadius = '50%';
        this.element.style.background = this.color;
        this.element.style.pointerEvents = 'none';
        this.element.style.zIndex = '9998';
        this.element.style.boxShadow = `0 0 10px ${this.color}`;
        document.body.appendChild(this.element);
    }
    
    update() {
        this.x += this.speedX;
        this.y += this.speedY;
        this.opacity -= 0.02;
        
        this.element.style.left = this.x + 'px';
        this.element.style.top = this.y + 'px';
        this.element.style.opacity = this.opacity;
        
        if (this.opacity <= 0) {
            this.element.remove();
            return false;
        }
        return true;
    }
}

document.addEventListener('mousemove', (e) => {
    if (Math.random() > 0.8) {
        particles.push(new Particle(e.clientX, e.clientY));
    }
    
    particles = particles.filter(particle => particle.update());
    
    if (particles.length > particleCount) {
        const removed = particles.shift();
        removed.element.remove();
    }
});

const brandTitle = document.querySelector('.brand-title');
if (brandTitle) {
    let floatDirection = 1;
    setInterval(() => {
        const currentTransform = brandTitle.style.transform || 'translateY(0px)';
        const currentY = parseFloat(currentTransform.match(/-?\d+\.?\d*/)?.[0] || 0);
        const newY = currentY + (0.5 * floatDirection);
        
        if (Math.abs(newY) > 5) {
            floatDirection *= -1;
        }
        
        brandTitle.style.transform = `translateY(${newY}px)`;
        brandTitle.style.transition = 'transform 0.1s ease';
    }, 50);
}

const formFields = document.querySelectorAll('.form-field');
formFields.forEach(field => {
    field.addEventListener('focus', function() {
        this.parentElement.style.filter = 'drop-shadow(0 0 15px rgba(0, 234, 255, 0.5))';
    });
    field.addEventListener('blur', function() {
        this.parentElement.style.filter = 'none';
    });
});

const submitBtn = document.querySelector('.btn-submit');
if (submitBtn) {
    submitBtn.addEventListener('click', function(e) {
        const ripple = document.createElement('span');
        const rect = this.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        const x = e.clientX - rect.left - size / 2;
        const y = e.clientY - rect.top - size / 2;
        
        ripple.style.width = ripple.style.height = size + 'px';
        ripple.style.left = x + 'px';
        ripple.style.top = y + 'px';
        ripple.style.position = 'absolute';
        ripple.style.borderRadius = '50%';
        ripple.style.background = 'rgba(255,255,255,0.6)';
        ripple.style.transform = 'scale(0)';
        ripple.style.animation = 'ripple 0.6s ease-out';
        ripple.style.pointerEvents = 'none';
        
        this.appendChild(ripple);
        setTimeout(() => ripple.remove(), 600);
    });
}

const style = document.createElement('style');
style.textContent = `
    @keyframes ripple {
        to {
            transform: scale(4);
            opacity: 0;
        }
    }
`;
document.head.appendChild(style);
</script>
{% endblock %}
